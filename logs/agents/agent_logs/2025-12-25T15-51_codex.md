# Agent Log — 2025-12-25T15-51Z (Codex / GPT-5.2)

## Session scope
- Task: repo onboarding (“Onboard”).
- Goal: understand repo purpose, key invariants/entrypoints, and current paper-grid state; run a very small smoke run.

## Key docs reviewed
- `agents.md` (repo-wide operating rules; keep runs <5 min; write agent logs; no git workflows).
- `docs/AGENT_ONBOARDING.md` (mental model + entrypoints + workflows).
- `README.md`, `docs/DATA.md`, `docs/TIME_AGG_EXPERIMENTS.md`, `docs/plan_for_working_paper_results.md`, `docs/FAMILY_A_RESULTS.md`, `docs/EDA_REPORT.md`.

## Repo mental model (1 paragraph)
Avazu CTR experiments with strict out-of-time evaluation and online-safe feature simulation. Baselines use time-aware target encoding (TE) and “Family A” entity-history time aggregation features computed so rows at hour H only use history from <H. The research focus for the working paper is Family A window *shapes* (A.1) and *length sets* (A.2), with Fold A/B “rolling-tail” stability checks and paired inference tooling (DeLong for ROC-AUC, block bootstrap for PR-AUC).

## Key entrypoints
- Single run: `kaggle_clicks/run_baseline_te.py`
- Sweeps: `kaggle_clicks/run_sweep_family_a.py`, `kaggle_clicks/run_sweep_family_a_full_grid.py`
- Inference: `kaggle_clicks/postprocess_sweep_inference.py`, `kaggle_clicks/inference_auc.py`, `kaggle_clicks/inference_bootstrap.py`
- Time split utils: `kaggle_clicks/time_utils.py`
- Feature builders: `kaggle_clicks/te.py`, `kaggle_clicks/time_agg.py`

## Smoke run executed (fast)
Command:
`python -m kaggle_clicks.run_baseline_te --sample-parquet data/interim/train_sample_0p1pct.parquet --n-estimators 50 --learning-rate 0.1 --max-depth 6 --n-jobs 2 --time-agg-windows 1 6 24 --run-tag onboard_smoke --export-preds`

Outputs:
- Run dir: `runs/20251225_155042_onboard_smoke/`
  - `report.md`, `metrics.json`, `model.json`, `preds_val.parquet`, `preds_test.parquet`

Notes:
- The run succeeded quickly.
- The report shows “Sample fraction: 1%” despite using `train_sample_0p1pct.parquet`; row count (~40k) matches ~0.1% of Avazu, so the reporting field likely reflects default `--sample-pct` rather than the parquet’s true sampling rate.
- Repeated warning on CLI help/run: joblib “Permission denied … operate in serial mode”; XGBoost threading still works via `--n-jobs`.

## Current paper artifacts noticed (from open tabs)
- No-TE ablation sweep summary: `runs/sweeps/20251225_032302_paper_full_grid_10pct_noTE_s10pct/summary.md`
- No-TE master ranking table: `runs/sweeps/20251225_032302_paper_full_grid_10pct_noTE_s10pct/master_results.md`
- TE+time-agg contrasts vs trailing (DeLong on test): `paper_draft/v1/10pct_paper_grid/contrasts_vs_trailing_test.md`
- Inference tables:
  - `paper_draft/v1/10pct_paper_grid/inference_vs_baseline.csv`
  - `runs/sweeps/20251220_180811_rolling_tail_5pct_promo_s5pct/inference_vs_baseline.csv`

