# Agent Log — Automatic RAM Throttling for Full-Grid Sweep

- Agent: Codex CLI
- Model: GPT-5.2
- Created (UTC): 2025-12-21T17:22:56+00:00

## Goal

Make the 20×2 (40-run) sweep safe to run unattended by automatically throttling concurrency based on available RAM (avoid OOM kills / swap thrash), while still enabling faster-than-serial throughput.

## Changes

- `kaggle_clicks/run_sweep_family_a_full_grid.py`
  - Added a /proc-based memory gate (no external deps).
  - New flags:
    - `--ram-budget-gib` (approx “cap total RAM usage”)
    - `--min-mem-available-gib` (hard floor for MemAvailable)
    - `--min-swap-free-gib` (avoid swap thrash)
  - When memory is low, the scheduler logs `PAUSE_MEM ...` and temporarily stops launching new runs until enough memory is available.
- `docs/AGENT_ONBOARDING.md`
  - Documented unattended memory-throttled sweep settings.

## Smoke validation

- Forced a pause by setting an impossibly low budget:
  - `python -m kaggle_clicks.run_sweep_family_a_full_grid --sample-pct 1 --sample-parquet data/interim/train_sample_0p1pct.parquet --sweep-tag memgate_smoke --max-wall-seconds 2 --max-parallel-runs 2 --ram-budget-gib 1 --n-jobs 1`
- Output:
  - `runs/sweeps/20251221_172229_memgate_smoke_s1pct/sweep.log` contains `PAUSE_MEM ...`

## Recommended starting point (25 GiB budget)

- `--max-parallel-runs 2 --n-jobs 1 --ram-budget-gib 25`

